{"map":"{\"version\":3,\"file\":\"relativeTime.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../src/relativeTime.ts\"],\"names\":[],\"mappings\":\"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\"}","code":"import { EventAggregator } from \"aurelia-event-aggregator\";\nimport { I18N, I18N_EA_SIGNAL } from \"./i18n\";\nimport { translations } from \"./defaultTranslations/relative.time\";\nvar RelativeTime = /** @class */ (function () {\n    function RelativeTime(service, ea) {\n        var _this = this;\n        this.service = service;\n        this.ea = ea;\n        this.service.i18nextReady().then(function () {\n            _this.setup();\n        });\n        this.ea.subscribe(I18N_EA_SIGNAL, function (locales) {\n            _this.setup(locales);\n        });\n    }\n    RelativeTime.inject = function () { return [I18N, EventAggregator]; };\n    RelativeTime.prototype.setup = function (locales) {\n        var trans = translations.default || translations;\n        var fallbackLng = this.service.i18next.fallbackLng;\n        var alternateFb = fallbackLng || this.service.i18next.options.fallbackLng;\n        if (Array.isArray(alternateFb) && alternateFb.length > 0) {\n            alternateFb = alternateFb[0];\n        }\n        var key = ((locales && locales.newValue)\n            ? locales.newValue\n            : this.service.getLocale()) || alternateFb;\n        var index = 0;\n        // tslint:disable-next-line:no-conditional-assignment\n        if ((index = key.indexOf(\"-\")) >= 0) {\n            var baseLocale = key.substring(0, index);\n            if (trans[baseLocale]) {\n                this.addTranslationResource(baseLocale, trans[baseLocale].translation);\n            }\n        }\n        if (trans[key]) {\n            this.addTranslationResource(key, trans[key].translation);\n        }\n        if (trans[fallbackLng]) {\n            this.addTranslationResource(key, trans[fallbackLng].translation);\n        }\n    };\n    RelativeTime.prototype.addTranslationResource = function (key, translation) {\n        var options = this.service.i18next.options;\n        if (options.interpolation && (options.interpolation.prefix !== \"__\" || options.interpolation.suffix !== \"__\")) {\n            // tslint:disable-next-line:forin\n            for (var subkey in translation) {\n                translation[subkey] = translation[subkey]\n                    .replace(\"__count__\", (options.interpolation.prefix || \"{{\") + \"count\" + (options.interpolation.suffix || \"}}\"));\n            }\n        }\n        this.service.i18next.addResources(key, options.defaultNS || \"translation\", translation);\n    };\n    RelativeTime.prototype.getRelativeTime = function (time) {\n        var now = new Date();\n        var diff = now.getTime() - time.getTime();\n        var timeDiff = this.getTimeDiffDescription(diff, \"year\", 31104000000);\n        if (!timeDiff) {\n            timeDiff = this.getTimeDiffDescription(diff, \"month\", 2592000000);\n            if (!timeDiff) {\n                timeDiff = this.getTimeDiffDescription(diff, \"day\", 86400000);\n                if (!timeDiff) {\n                    timeDiff = this.getTimeDiffDescription(diff, \"hour\", 3600000);\n                    if (!timeDiff) {\n                        timeDiff = this.getTimeDiffDescription(diff, \"minute\", 60000);\n                        if (!timeDiff) {\n                            timeDiff = this.getTimeDiffDescription(diff, \"second\", 1000);\n                            if (!timeDiff) {\n                                timeDiff = this.service.tr(\"now\");\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        return timeDiff;\n    };\n    RelativeTime.prototype.getTimeDiffDescription = function (diff, unit, timeDivisor) {\n        var unitAmount = parseInt((diff / timeDivisor).toFixed(0), 10);\n        if (unitAmount > 0) {\n            return this.service.tr(unit, { count: unitAmount, context: \"ago\" });\n        }\n        else if (unitAmount < 0) {\n            var abs = Math.abs(unitAmount);\n            return this.service.tr(unit, { count: abs, context: \"in\" });\n        }\n        return null;\n    };\n    return RelativeTime;\n}());\nexport { RelativeTime };\n//# sourceMappingURL=relativeTime.js.map"}
